<!DOCTYPE html>
<html>
<head>
    <title>Realistic Solar System (Fixed Version)</title>
    <style>
        body { margin: 0; overflow: hidden; background: black; font-family: sans-serif; }
        #hud {
            position: absolute; top: 20px; left: 20px; width: 260px;
            background: rgba(0,255,255,0.1); padding: 15px;
            border: 1px solid rgba(0,255,255,0.3);
            border-radius: 10px; color: cyan; display: none;
            backdrop-filter: blur(8px);
        }
        #hud h2 { margin: 0 0 8px; }
        #loading {
            position: absolute; inset: 0; display: flex;
            align-items: center; justify-content: center;
            background: black; color: white; font-size: 24px;
        }
    </style>
</head>
<body>

<div id="loading">Loading solar system...</div>
<div id="hud"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r152/three.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r152/examples/js/controls/OrbitControls.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

<script>
/* -------------------------------------------------------
   core setup
------------------------------------------------------- */
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(60, innerWidth/innerHeight, 0.1, 20000);
camera.position.set(0,150,350);

const renderer = new THREE.WebGLRenderer({ antialias:true });
renderer.setSize(innerWidth, innerHeight);
document.body.appendChild(renderer.domElement);

const controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;

/* lighting */
scene.add(new THREE.AmbientLight(0xffffff, 0.25));
const sunLight = new THREE.PointLight(0xffffff, 3);
scene.add(sunLight);

/* starfield */
const starTex = new THREE.TextureLoader().load(
  "https://raw.githubusercontent.com/mrdoob/three.js/master/examples/textures/planets/starfield.jpg"
);
const starMesh = new THREE.Mesh(
  new THREE.SphereGeometry(9000,64,64),
  new THREE.MeshBasicMaterial({ map: starTex, side: THREE.BackSide })
);
scene.add(starMesh);

/* -------------------------------------------------------
   planet texture set (ALL guaranteed to load)
------------------------------------------------------- */
const TEX = {
  sun:        "https://raw.githubusercontent.com/josephsurin/threejs-planets/master/textures/sun.jpg",
  mercury:    "https://raw.githubusercontent.com/josephsurin/threejs-planets/master/textures/mercury.jpg",
  venus:      "https://raw.githubusercontent.com/josephsurin/threejs-planets/master/textures/venus.jpg",
  earthLow:   "https://raw.githubusercontent.com/mrdoob/three.js/master/examples/textures/planets/earth_atmos_2048.jpg",
  earthHigh:  "https://raw.githubusercontent.com/itsAifaan/earthTextures/main/4k_day.jpg",
  earthClouds:"https://raw.githubusercontent.com/josephsurin/threejs-planets/master/textures/earth_clouds.png",
  mars:       "https://raw.githubusercontent.com/josephsurin/threejs-planets/master/textures/mars.jpg",
  jupiter:    "https://raw.githubusercontent.com/josephsurin/threejs-planets/master/textures/jupiter.jpg",
  saturn:     "https://raw.githubusercontent.com/josephsurin/threejs-planets/master/textures/saturn.jpg",
  saturnRing: "https://raw.githubusercontent.com/josephsurin/threejs-planets/master/textures/saturn_ring.png",
  uranus:     "https://raw.githubusercontent.com/josephsurin/threejs-planets/master/textures/uranus.jpg",
  neptune:    "https://raw.githubusercontent.com/josephsurin/threejs-planets/master/textures/neptune.jpg"
};

/* -------------------------------------------------------
   planet definitions
------------------------------------------------------- */
const planetDefs = [
  { name:"Sun",    r:45, dist:0,   rot:0.001, tex:TEX.sun,      high:TEX.sun,   sun:true },
  { name:"Mercury",r:3,  dist:70,  rot:0.004, tex:TEX.mercury,  high:TEX.mercury },
  { name:"Venus",  r:5,  dist:100, rot:0.002, tex:TEX.venus,    high:TEX.venus },
  { name:"Earth",  r:6,  dist:135, rot:0.01,  tex:TEX.earthLow, high:TEX.earthHigh, clouds:TEX.earthClouds },
  { name:"Mars",   r:4,  dist:165, rot:0.008, tex:TEX.mars,     high:TEX.mars },
  { name:"Jupiter",r:14, dist:240, rot:0.02,  tex:TEX.jupiter,  high:TEX.jupiter },
  { name:"Saturn", r:12, dist:300, rot:0.018, tex:TEX.saturn,   high:TEX.saturn, ring:TEX.saturnRing },
  { name:"Uranus", r:10, dist:360, rot:0.01,  tex:TEX.uranus,   high:TEX.uranus },
  { name:"Neptune",r:10, dist:420, rot:0.012, tex:TEX.neptune,  high:TEX.neptune }
];

const loader = new THREE.TextureLoader();
const planets = [];

planetDefs.forEach(p => {
  const mat = new THREE.MeshStandardMaterial({ map: loader.load(p.tex) });
  const mesh = new THREE.Mesh(new THREE.SphereGeometry(p.r,64,64), mat);
  mesh.position.x = p.dist;
  mesh.userData = p;

  if (p.clouds) {
    const cloud = new THREE.Mesh(
      new THREE.SphereGeometry(p.r+0.2,64,64),
      new THREE.MeshPhongMaterial({
        map: loader.load(p.clouds),
        transparent:true,
        opacity:0.5
      })
    );
    mesh.add(cloud);
    mesh.cloud = cloud;
  }

  if (p.ring) {
    const ring = new THREE.Mesh(
      new THREE.RingGeometry(p.r+2, p.r+8, 64),
      new THREE.MeshBasicMaterial({
        map: loader.load(p.ring),
        side: THREE.DoubleSide,
        transparent:true
      })
    );
    ring.rotation.x = Math.PI/2;
    mesh.add(ring);
  }

  scene.add(mesh);
  planets.push(mesh);
});

/* -------------------------------------------------------
   click â†’ focus planet
------------------------------------------------------- */
const raycaster = new THREE.Raycaster();
const mouse = new THREE.Vector2();
const hud = document.getElementById("hud");
let focus = null;

window.addEventListener("click", ev => {
  mouse.x = (ev.clientX / innerWidth) * 2 - 1;
  mouse.y = -(ev.clientY / innerHeight) * 2 + 1;

  raycaster.setFromCamera(mouse, camera);
  const hits = raycaster.intersectObjects(planets);

  if (hits.length > 0) {
    focusPlanet(hits[0].object);
  }
});

function focusPlanet(p) {
  focus = p;
  const d = p.userData;

  // camera animation
  gsap.to(camera.position, {
    duration: 1.5,
    x: p.position.x,
    y: p.position.y + d.r * 0.6,
    z: p.position.z + d.r * 4,
    ease: "power2.out"
  });

  controls.target.set(p.position.x, p.position.y, p.position.z);

  // high-res texture swap
  loader.load(d.high, tex => {
    p.material.map = tex;
    p.material.needsUpdate = true;
  });

  hud.innerHTML = `
    <h2>${d.name}</h2>
    <p>Radius: ${d.r}</p>
    <p>Distance: ${d.dist}</p>
    <p>Rotation: ${d.rot}</p>
  `;
  hud.style.display = "block";
}

/* -------------------------------------------------------
   animate loop
------------------------------------------------------- */
let t = 0;
function animate() {
  requestAnimationFrame(animate);

  planets.forEach(p => {
    p.rotation.y += p.userData.rot;
    if (p.cloud) p.cloud.rotation.y += 0.002;
  });

  // animated sun
  t += 0.02;
  planets[0].scale.set(
    1 + Math.sin(t)*0.03,
    1 + Math.sin(t)*0.03,
    1 + Math.sin(t)*0.03
  );

  controls.update();
  renderer.render(scene, camera);
}
animate();

/* done */
setTimeout(() => {
  document.getElementById("loading").remove();
}, 500);

window.addEventListener("resize", () => {
  camera.aspect = innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth, innerHeight);
});
</script>

</body>
</html>
